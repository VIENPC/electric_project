<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{admin/layout/layout :: admin(~{::title},~{::body})}">

<head>
	<meta charset="UTF-8">
	<title>Bảng điều khiển</title>
</head>

<body>
	<main class="app-content">
		<div class="col-md-12">
			<div class="row">
				<!-- col-6 -->
				<div class="col-md-3">
					<div class="widget-small primary coloured-icon">
						<i class='icon bx bxs-user-account fa-3x'></i>
						<div class="info">
							<h4>Tổng khách hàng</h4>
							<p>
								<b>[(${slkh})] khách hàng</b>
							</p>
							<p class="info-tong">Tổng số khách hàng được quản lý.</p>
						</div>
					</div>
				</div>
				<!-- col-6 -->
				<div class="col-md-3">
					<div class="widget-small info coloured-icon">
						<i class='icon bx bxs-data fa-3x'></i>
						<div class="info">
							<h4>Tổng sản phẩm</h4>
							<p>
								<b>[(${slsp})] sản phẩm</b>
							</p>
							<p class="info-tong">Tổng số sản phẩm được quản lý.</p>
						</div>
					</div>
				</div>
				<!-- col-6 -->
				<div class="col-md-3">
					<div class="widget-small warning coloured-icon">
						<i class='icon bx bxs-shopping-bags fa-3x'></i>
						<div class="info">
							<h4>Tổng đơn hàng</h4>
							<p>
								<b>[(${slhd})] đơn hàng</b>
							</p>
							<p class="info-tong">Tổng số hóa đơn bán hàng trong tháng.</p>
						</div>
					</div>
				</div>
				<!-- col-6 -->
				<div class="col-md-3">
					<div class="widget-small danger coloured-icon">
						<i class='icon bx bxs-error-alt fa-3x'></i>
						<div class="info">
							<h4>Hết hàng</h4>
							<p>
								<b>[(${slspht})] sản phẩm</b>
							</p>
							<p class="info-tong">Số sản phẩm cảnh báo hết cần nhập thêm.</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--END left-->

		<!-- Tabs Navigation -->
		<ul class="nav nav-tabs" id="myTabs" role="tablist">
			<li class="nav-item">
				<a class="nav-link active" id="tab1-tab" data-toggle="tab" href="#tab1" role="tab" aria-controls="tab1"
					aria-selected="true">Danh sách thương hiệu</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" id="tab2-tab" data-toggle="tab" href="#tab2" role="tab" aria-controls="tab2"
					aria-selected="false">Chỉnh sửa</a>
			</li>
		</ul>
		<!-- Tabs Content -->
		<div class="tab-content" id="myTabsContent">

			<div class="tab-pane fade show active" id="tab1" role="tabpanel" aria-labelledby="tab1-tab">
				<div class="row">
					<form th:action="@{/admin/category-by-month}" method="get" id="formloai" class="m-2">
						<select class="btn  btn-danger" name="categoryid" id="categoryid" onchange="submitFormLoai()">
							<option value="">- Thống kê theo loại --</option>
							<option th:each="hsx : ${listlsp}" th:text="${hsx.categoryName}" th:value="${hsx.categoryID}">
							</option>
						</select>
					</form>
					<form th:action="@{/admin/revenue-by-month}" method="get" id="formhang" class="m-2">
						<select class="btn btn-add" name="brandId" id="brandId" onchange="submitForm()">
							<option value="">- Thống kê theo hãng --</option>
							<option th:each="hsx : ${listhxs}" th:text="${hsx.brandName}" th:value="${hsx.brandID}">
							</option>
						</select>
					</form>
				</div>
				<div class="row">
					<div class="col-md-6">
						<figure class="highcharts-figure">
							<div id="container1" class=""></div>
							<button class="btn btn-excel" id="plain1">Dọc</button>
							<button class="btn btn-danger" id="inverted1">Ngang</button>
						</figure>
					</div>
					<div class="col-md-6">
						<div class="col-md-12">
							<figure class="highcharts-figure">
								<div id="container" class=""></div>
								<button class="btn btn-excel" id="plain">Dọc</button>
								<button class="btn btn-danger" id="inverted">Ngang</button>
							</figure>
						</div>
						<!-- Thống kê doanh thu theo ngày -->
					</div>

				</div>
				<div class="row">
					<div class="col-md-12">
						<figure class="highcharts-figure1">
							<div id="container2"></div>
							<p class="highcharts-description"></p>
						</figure>
					</div>
				</div>
				<table hidden="true" id="bang1">
					<tr th:each="hd : ${revenueData}">
						<td th:text="${hd[0]}"></td>
						<td th:text="${hd[1]}"></td>
					</tr>
				</table>
				<table hidden="true" id="bang2">
					<tr th:each="us : ${souser}">
						<td th:text="${us[0]}"></td>
						<td th:text="${us[1]}"></td>
					</tr>
				</table>

				<table hidden="true" id="bang3">
					<tr th:each="os : ${soOrder}">
						<td th:text="${os[0]}"></td>
						<td th:text="${os[1]}"></td>
					</tr>
				</table>
				<table hidden="true" id="bang4">
					<tr th:each="os : ${revenueDatamonth}">
						<td th:text="${os[0]}"></td>
						<td th:text="${os[1]}"></td>
					</tr>
				</table>
				<!-- col-12 -->
			</div>
			<div class="tab-pane fade" id="tab2" role="tabpanel" aria-labelledby="tab2-tab">


				<div class="col-md-12">
					<div class="tile">
						<div>
							<h3 class="tile-title">THỐNG KÊ DOANH THU THEO 1 NGÀY</h3>
						</div>
						<div class="col-sm-12">
							<form th:action="@{/admin/ngay}" method="get">
								<label for="targetDate">Ngày bắt đầu :</label> <input type="date" id="targetDate" class="form-control"
									name="targetDate"> <br>
								<button type="submit" class="btn btn-primary">Tìm kiếm</button>
								<br> <br>
								<p>Doanh thu ngày:</p>
								<h4 th:text="${#dates.format(ngay, 'dd/MM/yyyy')}"></h4> <br><br>
								<p>Tổng doanh thu là: </p>
								<h4 th:text="${#numbers.formatDecimal(doanhThuNgay, 0, 'COMMA', 0 , 'POINT')} + ' VND'">></h4>


							</form>
						</div>
						<br>
					</div>
				</div>
				<!-- Thống kê doanh thu theo ngày -->
				<div class="col-md-12">
					<div class="tile">
						<div>
							<h3 class="tile-title">THỐNG KÊ DOANH THU THEO NGÀY</h3>
						</div>
						<div class="col-sm-12">
							<form th:action="@{/admin/doanhthu}" method="get">
								<label for="startDate">Ngày bắt đầu :</label> <input type="date" id="startDate" name="startDate"> <label
									for="endDate">Ngày kết thúc :</label> <input type="date" id="endDate" name="endDate">
								<button type="submit">Tìm kiếm</button>
								<br> <br> <span>
									<h4>Ngày bắt đầu:</h4> <span th:text="${#dates.format(startDate, 'dd/MM/yyyy')}"></span>
									<h4>Ngày kết thúc:</h4> <span th:text="${#dates.format(endDate, 'dd/MM/yyyy')}"></span> <br><br>
									<h4>Tổng doanh thu là: <span
											th:text="${#numbers.formatDecimal(doanhThu, 0, 'COMMA', 0 , 'POINT')} + ' VND'">></span></h4>
								</span>
								<span>
									<h4>Ngày có doanh thu cao nhất: <span
											th:text="${#dates.format(ngayDoanhThuCaoNhat, 'dd/MM/yyyy')}"></span>
										thu được <span
											th:text="${#numbers.formatDecimal(doanhThuCaoNhat, 0, 'COMMA', 0 , 'POINT')} + ' VND'"></span>
									</h4>
								</span>
								<span>
									<h4>Ngày có doanh thu thấp nhất: <span
											th:text="${#dates.format(ngayDoanhThuThapNhat, 'dd/MM/yyyy')}"></span>
										thu được <span
											th:text="${#numbers.formatDecimal(doanhThuThapNhat, 0, 'COMMA', 0 , 'POINT')} + ' VND'"></span>
									</h4>
								</span>
							</form>
							<div class="card-header text-center"
								style="background-color: #cf6125; color: white; font-size: 18px; font-weight: 700; height: 45px; padding: 10px 0px; margin-bottom: 22px">
								Tất cả các đơn hàng</div>

							<table class="table table-hover table-bordered" id="myTable">
								<thead>
									<tr>
										<th><span>Mã Đơn Hàng</span></th>
										<th><span>Tên Người Nhận</span></th>
										<th><span>SĐT Người Nhận</span></th>
										<th><span>Địa Chỉ Nhận Hàng</span></th>
										<th><span>Ngày</span></th>
										<th><span>Đơn Giá</span></th>
										<th><span>Trạng Thái Hóa Đơn</span></th>
										<th><span>Trạng Thái Thanh Toán</span></th>
										<th><span>Ghi chú</span></th>
										<th><span></span></th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="order : ${orders}">
										<td th:text="${order.orderId}"></td>
										<td th:text="${order.name}"></td>
										<td th:text="${order.phone}"></td>
										<td th:text="${order.address}"></td>
										<td th:text="${#dates.format(order.orderDate, 'dd/MM/yyyy')}"></td>

										<td><span
												th:text="${#numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 0 , 'POINT')} + ' VND'"></span>
										</td>
										<td><span class="badge badge-warning" th:if="${order.statushd == 1}">Chờ
												xác nhận</span> <span class="badge badge-warning" th:if="${order.statushd == 2}">Đã
												xác nhận</span> <span class="badge badge-warning" th:if="${order.statushd == 3}">Đang
												giao</span> <span class="badge badge-warning" th:if="${order.statushd == 4}">Hoàn
												thành</span> <span class="badge badge-warning" th:if="${order.statushd == 5}">Hủy</span>
										</td>
										<td>
											<a class="btn btn-danger btn-sm" th:if="${not order.statustt && order.statushd == 1}"
												th:href="@{'/user/huythanhtoan/' + ${order.orderId}}" onclick="cancelPayment()">
												<i class="fa fa-times" aria-hidden="true"></i> Hủy
												đơn hàng
											</a>
											<span th:if="${not order.statustt && order.statushd > 1}" class="badge badge-warning">Chờ thanh
												toán</span>
											<span th:if="${order.statustt}" class="badge badge-success">Đã thanh toán</span>
										</td>
										<td th:text="${order.note}"></td>
										<td><a class="btn btn-primary btn-sm" th:href="@{'/user/xemhoadonct/' + ${order.orderId}}">
												<i class="fa fa-eye" aria-hidden="true"></i>
											</a> <br></td>


									</tr>
								</tbody>
							</table>
						</div>
						<br>
					</div>
				</div>
			</div>
		</div>







	</main>
</body>

</html>